{% extends "layout.html" %}


{% block title %}Edit reference{% endblock %}
{% block content %}
<h2>Edit reference</h2>
<i>* required information</i>
<form action="/update_reference/{{reference.id }}" method="POST">
    <p>
    <label for="ref_type">Reference type</label>
    <select name="ref_type" id="ref_type" required>
        <option value="book" {% if reference.ref_type == "book" %}selected{% endif %}>Book</option>
        <option value="article" {% if reference.ref_type == "article" %}selected{% endif %}>Article</option>
        <option value="inproceedings" {% if reference.ref_type == "inproceedings" %}selected{% endif %}>Inproceedings</option>
    </select>
    </p>
    <p>
        <label for="author">Author(s):</label> 
        <input type="text" name="author" id="author" value ="{{ reference.author }}" required> *
    </p>
    <p>
        <label for="title">Title:</label>
        <input type="text" name="title" id="title" value ="{{ reference.title }}" required> *
    </p>
    <p>
        <label for="year">Year:</label>
        <input type="number" name="year" id="year" value ="{{ reference.year }}" required> *
        {% if errors.year %}
            <br><span style="color:red;">{{ errors.year }}</span>
        {% endif %}
    </p>
    <p data-type-only="article">
        <label for="journal">Journal:</label>
        <input type="text" name="journal" id="journal" value ="{{ reference.journal }}">
        {% if errors.journal %}
        <br><span style="color:red;">{{ errors.journal }}</span>
        {% endif %}
        <label for="volume">Volume:</label>
        <input type="text" name="volume" id="volume" value ="{{ reference.volume }}">
        {% if errors.volume %}
        <br><span style="color:red;">{{ errors.volume }}</span>
        {% endif %}

        <label for="pages">Pages</label>
        <input type="text" name="pages" id="pages" value ="{{ reference.pages }}">
    </p>
    <p data-type-only="book">
        <label for="publisher">Publisher</label>
        <input type="text" name="publisher" id="publisher" value ="{{ reference.publisher }}">
        {% if errors.publisher %}
        <br><span style="color:red;">{{ errors.publisher }}</span>
        {% endif %}
    </p>
    <p data-type-only="inproceedings">
        <label for="booktitle">Booktitle</label>
        <input type="text" name="booktitle" id="booktitle" value ="{{ reference.booktitle }}">
        {% if errors.booktitle %}
        <br><span style="color:red;">{{ errors.booktitle }}</span>
        {% endif %}
        <!-- <label for="edition">Edition</label>
        <input type="text" name="edition" id="edition"> -->
        <!-- <label for="chapter">Chapter</label>
        <input type="text" name="chapter" id="chapter"> -->
    </p>

    <!-- <p>
        <label for="doi">DOI</label>
        <input type="text" name="doi" id="doi">
    </p> -->
    <!-- <p>
        <label for="address">Address</label>
        <input type="text" name="address" id="address"> -->
    <input type="submit" value="Edit reference"/>
</form>

<script>
    function updateFieldsByType() {
        const typeSelect = document.getElementById("ref_type");
        const selectedType = typeSelect.value;

        const groups = document.querySelectorAll("[data-type-only]");
        groups.forEach(function(el) {
            el.style.display = "none";
        });
        
    
        const visibleGroups = document.querySelectorAll('[data-type-only="' + selectedType + '"]');
        visibleGroups.forEach(function(el) {
            el.style.display = "block";
        });    
    }

    document.addEventListener("DOMContentLoaded", function() {
        const typeSelect = document.getElementById("ref_type");
        typeSelect.addEventListener("change", updateFieldsByType);
        updateFieldsByType();
    });
</script>

{% endblock %}
